# Functions used for manipulation of source object (fix invalid structure + remove unnecessary properties + add info like UserLoggedOn, Computer, CollectionTime)
Convert-CimArrayToObjectFixStructure
Convert-PSArrayToObjectFixStructure
Add-ColumnDataToAllEntriesInArray
Add-CollectionTimeToAllEntriesInArray
Filter-ObjectExcludeProperty
Build-DataArrayToAlignWithSchema

# Validation of environment (Azure LogAnalytics custom log tables, Azure Data Collection Rules, schema)
ValidateFix-AzLogAnalyticsTableSchemaColumnNames
CheckCreateUpdate-TableDcr-Structure
Get-AzLogAnalyticsTableAzDataCollectionRuleStatus
Get-ObjectSchemaAsArray
Get-ObjectSchemaAsHash

# Management (create/update) of Azure LogAnalytics tables & Azure Data Collection Rules Management - with required schema-format and valid data set
CreateUpdate-AzLogAnalyticsCustomLogTableDcr
CreateUpdate-AzDataCollectionRuleLogIngestCustomLog

# Targetting of where to send data using names - lookup of DCR/DCE infrastructure using Azure Resource Graph
Get-AzDcrListAll
Get-AzDceListAll
Get-AzDcrDceDetails

# Post data to Azure LogAnalytics custom log tables using log ingestion API and Azure Data Collection Rules
Post-AzLogAnalyticsLogIngestCustomLogDcrDce

# Management of existing Azure Data Collection Rules
Update-AzDataCollectionRuleTransformKql
Update-AzDataCollectionRuleResetTransformKqlDefault
Update-AzDataCollectionRuleDceEndpoint

# Management of existing Azure LogAnalytics custom log tables & Azure Data Collection Rules to update schema when source object structure changes
Update-AzDataCollectionRuleLogAnalyticsCustomLogTableSchema

# Merged funtions to call other functions to optimize size of code
CheckCreateUpdate-TableDcr-Structure
Post-AzLogAnalyticsLogIngestCustomLogDcrDce-Output

# Clean-up/maintenance of existing Azure LogAnalytics tables & Azure Data Collection Rules
Delete-AzLogAnalyticsCustomLogTables
Delete-AzDataCollectionRules

# Clean-up/maintenance of existing Azure LogAnalytics custom log tables & Azure Data Collection Rules
Delete-AzLogAnalyticsCustomLogTables
Delete-AzDataCollectionRules
